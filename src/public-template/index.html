<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate Manager</title>
    <link rel="shortcut icon" href="img/favicon.svg" type="image/svg+xml">
    <link rel="alternate icon" href="img/favicon.png" type="image/png">

    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/tabs.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="css/ui-states.css">
    <link rel="stylesheet" href="css/file-browser.css">
    <link rel="stylesheet" href="css/deploy-actions.css">
    
    <script src="/fontawesome/fontawesome.js"></script>
    <script src="/fontawesome/all.js"></script>
</head>
<body>
    <header class="app-header">
        <div class="app-logo">
            <object id="logo-svg" data="img/favicon.svg" type="image/svg+xml" class="logo-svg"></object>
            <h1>Certificate Manager</h1>
        </div>
        <nav>
            <ul>
                <li><a href="#dashboard" class="active" data-tab="dashboard">Dashboard</a></li>
                <li><a href="#certificates" data-tab="certificates">Certificates</a></li>
                <li><a href="#ca" data-tab="ca">CA Certificates</a></li>
                <li><a href="#settings" data-tab="settings">Settings</a></li>
                <li><a href="#logs" data-tab="logs">Logs</a></li>
                <li><a href="/api/docs" target="_blank">API Docs</a></li>
            </ul>
        </nav>
        <div class="user-menu">
            <button id="theme-toggle" title="Toggle dark/light mode">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path class="sun-icon" d="M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm5 12h-10v-1.5c0-1.38 1.12-2.5 2.5-2.5h5c1.38 0 2.5 1.12 2.5 2.5v1.5z"></path>
                    <path class="moon-icon" d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"></path>
                </svg>
            </button>
        </div>
    </header>

    <main>
        <!-- Dashboard Tab -->
        <section id="dashboard" class="tab-content active">
            <div class="dashboard-header">
                <h1>Certificate Dashboard</h1>
                <button id="refresh-dashboard" class="button"><i class="icon-refresh"></i> Refresh</button>
            </div>
            
            <div id="dashboard-content">
                <!-- Dashboard content will be loaded here -->
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card" id="cert-stats-container">
                    <h2 class="card-title">Certificate Statistics</h2>
                    <div id="cert-stats" class="card-content"></div>
                </div>
                
                <div class="dashboard-card" id="expiring-certs-container">
                    <h2 class="card-title">Expiring Certificates</h2>
                    <div id="expiring-certs-list" class="card-content"></div>
                </div>
                
                <div class="dashboard-card" id="ca-summary-container">
                    <h2 class="card-title">CA Certificates</h2>
                    <div id="ca-list-summary" class="card-content"></div>
                </div>
                
                <div class="dashboard-card" id="recent-activity-container">
                    <h2 class="card-title">Recent Activity</h2>
                    <div id="recent-activity" class="card-content"></div>
                </div>
            </div>
        </section>

        <!-- Certificates Tab -->
        <section id="certificates" class="tab-content">
            <div class="certificates-header">
                <h2>Certificates</h2>
                <div class="certificate-actions">
                    <button id="create-cert-btn" class="button primary">Create Certificate</button>
                    <button id="refresh-certs" class="button">Refresh</button>
                </div>
            </div>
            <div class="filter-bar">
                <input type="text" id="cert-search" placeholder="Search certificates...">
                <div class="filter-options">
                    <label>
                        <input type="checkbox" id="filter-valid" checked>
                        Valid
                    </label>
                    <label>
                        <input type="checkbox" id="filter-expiring" checked>
                        Expiring Soon
                    </label>
                    <label>
                        <input type="checkbox" id="filter-expired" checked>
                        Expired
                    </label>
                </div>
            </div>
            <div class="certificates-list" id="certificates-list">
                <div class="loading">Loading certificates...</div>
            </div>
        </section>

        <!-- CA Certificates Tab -->
        <section id="ca" class="tab-content">
            <div class="ca-header">
                <h2>CA Certificates</h2>
                <div class="ca-actions">
                    <button id="create-ca-btn" class="button primary">Create CA</button>
                    <button id="refresh-ca" class="button">Refresh</button>
                </div>
            </div>
            <div class="ca-certificates" id="ca-certificates">
                <div class="loading">Loading CA certificates...</div>
            </div>
        </section>

        <!-- Settings Tab -->
        <section id="settings" class="tab-content">
            <h2>Settings</h2>
            <div class="settings-container">
                <div class="settings-sidebar">
                    <ul>
                        <li><a href="#general-settings" class="active">General</a></li>
                        <li><a href="#security-settings">Security</a></li>
                        <li><a href="#renewal-settings">Auto-Renewal</a></li>
                        <li><a href="#notification-settings">Notifications</a></li>
                        <li><a href="#backup-settings">Backup</a></li>
                    </ul>
                </div>
                <div class="settings-content">
                    <div id="general-settings" class="settings-panel active">
                        <h3>General Settings</h3>
                        <form id="general-settings-form">
                            <div class="form-group">
                                <label for="cert-path">Certificates Path</label>
                                <div class="input-with-button">
                                    <input type="text" id="cert-path" name="certPath">
                                    <button type="button" class="browse-btn" data-target="cert-path">Browse</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="log-level">Log Level</label>
                                <select id="log-level" name="logLevel">
                                    <option value="error">Error</option>
                                    <option value="warn">Warning</option>
                                    <option value="info">Info</option>
                                    <option value="debug">Debug</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="openssl-path">OpenSSL Path</label>
                                <input type="text" id="openssl-path" name="openSSLPath">
                            </div>
                            <button type="submit" class="button primary">Save Settings</button>
                        </form>
                    </div>

                    <div id="security-settings" class="settings-panel">
                        <h3>Security Settings</h3>
                        <form id="security-settings-form">
                            <div class="form-group checkbox">
                                <input type="checkbox" id="enable-https" name="enableHttps">
                                <label for="enable-https">Enable HTTPS</label>
                            </div>
                            <div class="form-group https-settings">
                                <label for="https-port">HTTPS Port</label>
                                <input type="number" id="https-port" name="httpsPort" min="1" max="65535">
                            </div>
                            <div class="form-group https-settings">
                                <label for="https-cert">HTTPS Certificate Path</label>
                                <div class="input-with-button">
                                    <input type="text" id="https-cert" name="httpsCertPath">
                                    <button type="button" class="browse-btn" data-target="https-cert">Browse</button>
                                </div>
                            </div>
                            <div class="form-group https-settings">
                                <label for="https-key">HTTPS Key Path</label>
                                <div class="input-with-button">
                                    <input type="text" id="https-key" name="httpsKeyPath">
                                    <button type="button" class="browse-btn" data-target="https-key">Browse</button>
                                </div>
                            </div>
                            <button type="submit" class="button primary">Save Settings</button>
                        </form>
                    </div>

                    <div id="renewal-settings" class="settings-panel">
                        <h3>Auto-Renewal Settings</h3>
                        <form id="renewal-settings-form">
                            <div class="form-group checkbox">
                                <input type="checkbox" id="enable-auto-renewal" name="enableAutoRenewalJob">
                                <label for="enable-auto-renewal">Enable Auto-Renewal</label>
                            </div>
                            <div class="form-group">
                                <label for="renewal-schedule">Renewal Schedule (cron)</label>
                                <input type="text" id="renewal-schedule" name="renewalSchedule" placeholder="0 0 * * *">
                                <span class="form-help">Format: minute hour day month weekday</span>
                            </div>
                            <div class="form-group">
                                <label for="renew-days">Days Before Expiry</label>
                                <input type="number" id="renew-days" name="renewDaysBeforeExpiry" min="1" max="90">
                            </div>
                            <div class="form-group checkbox">
                                <input type="checkbox" id="enable-file-watch" name="enableFileWatch">
                                <label for="enable-file-watch">Watch for Certificate Changes</label>
                            </div>
                            <button type="submit" class="button primary">Save Settings</button>
                        </form>
                    </div>

                    <div id="notification-settings" class="settings-panel">
                        <h3>Notification Settings</h3>
                        <p>Configure notifications for certificate events.</p>
                        <form id="notification-settings-form">
                            <!-- Placeholder for future notification settings -->
                            <p class="placeholder-note">Notification settings will be available in a future update.</p>
                            <button type="submit" class="button primary" disabled>Save Settings</button>
                        </form>
                    </div>

                    <div id="backup-settings" class="settings-panel">
                        <h3>Backup Settings</h3>
                        <form id="backup-settings-form">
                            <div class="form-group checkbox">
                                <input type="checkbox" id="enable-backups" name="enableCertificateBackups">
                                <label for="enable-backups">Enable Certificate Backups</label>
                            </div>
                            <div class="form-group checkbox">
                                <input type="checkbox" id="keep-backups" name="keepBackupsForever">
                                <label for="keep-backups">Keep Backups Forever</label>
                            </div>
                            <div class="form-group" id="backup-retention-group">
                                <label for="backup-retention">Backup Retention (days)</label>
                                <input type="number" id="backup-retention" name="backupRetention" min="1" max="365">
                            </div>
                            <button type="submit" class="button primary">Save Settings</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Logs Tab -->
        <section id="logs" class="tab-content">
            <h2>System Logs</h2>
            <div class="logs-controls">
                <label>
                    <span>Log Level:</span>
                    <select id="log-filter-level">
                        <option value="all">All Levels</option>
                        <option value="error">Error</option>
                        <option value="warn">Warning</option>
                        <option value="info">Info</option>
                        <option value="debug">Debug</option>
                    </select>
                </label>
                <label>
                    <span>Search:</span>
                    <input type="text" id="log-search" placeholder="Filter logs...">
                </label>
                <button id="refresh-logs" class="button">Refresh</button>
                <button id="clear-logs" class="button">Clear View</button>
            </div>
            <div class="logs-container">
                <div id="logs-output" class="logs-output"></div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <div id="modal-backdrop" class="modal-backdrop hidden"></div>

    <!-- Certificate Create/Edit Modal -->
    <div id="certificate-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="cert-modal-title">Create Certificate</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="certificate-form">
                    <input type="hidden" id="cert-id" name="id">
                    
                    <div class="form-group">
                        <label for="cert-name">Certificate Name</label>
                        <input type="text" id="cert-name" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-type">Certificate Type</label>
                        <select id="cert-type" name="type">
                            <option value="standard">Standard Certificate</option>
                            <option value="rootCA">Root CA Certificate</option>
                            <option value="intermediateCA">Intermediate CA Certificate</option>
                        </select>
                    </div>
                    
                    <div id="standard-cert-fields">
                        <div class="form-group">
                            <label for="cert-common-name">Common Name (Domain)</label>
                            <input type="text" id="cert-common-name" name="commonName" placeholder="example.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="cert-alt-names">Alternative Names</label>
                            <textarea id="cert-alt-names" name="altNames" placeholder="www.example.com&#10;api.example.com"></textarea>
                            <span class="form-help">One domain per line</span>
                        </div>
                    </div>
                    
                    <div id="ca-cert-fields" class="hidden">
                        <div class="form-group">
                            <label for="ca-common-name">CA Name</label>
                            <input type="text" id="ca-common-name" name="caName" placeholder="My Certificate Authority">
                        </div>
                        
                        <div class="form-group">
                            <label for="ca-organization">Organization</label>
                            <input type="text" id="ca-organization" name="organization" placeholder="My Organization">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-country">Country Code</label>
                        <input type="text" id="cert-country" name="country" placeholder="US" maxlength="2">
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-state">State/Province</label>
                        <input type="text" id="cert-state" name="state" placeholder="California">
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-locality">City/Locality</label>
                        <input type="text" id="cert-locality" name="locality" placeholder="San Francisco">
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-organization">Organization</label>
                        <input type="text" id="cert-organization" name="organization" placeholder="My Organization">
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-org-unit">Organizational Unit</label>
                        <input type="text" id="cert-org-unit" name="organizationalUnit" placeholder="IT Department">
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-email">Email Address</label>
                        <input type="email" id="cert-email" name="email" placeholder="admin@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="cert-validity">Validity Period (days)</label>
                        <input type="number" id="cert-validity" name="validityDays" min="1" value="90">
                    </div>
                    
                    <div class="form-group checkbox">
                        <input type="checkbox" id="cert-passphrase" name="usePassphrase">
                        <label for="cert-passphrase">Protect with Passphrase</label>
                    </div>
                    
                    <div id="passphrase-fields" class="hidden">
                        <div class="form-group">
                            <label for="cert-passphrase-value">Passphrase</label>
                            <input type="password" id="cert-passphrase-value" name="passphrase">
                        </div>
                        
                        <div class="form-group">
                            <label for="cert-passphrase-confirm">Confirm Passphrase</label>
                            <input type="password" id="cert-passphrase-confirm" name="passphraseConfirm">
                        </div>
                    </div>
                    
                    <div class="form-group checkbox">
                        <input type="checkbox" id="cert-auto-renew" name="autoRenew" checked>
                        <label for="cert-auto-renew">Auto-Renew Before Expiry</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="button" id="cert-modal-cancel">Cancel</button>
                <button class="button primary" id="cert-modal-save">Create</button>
            </div>
        </div>
    </div>

    <!-- Certificate Details Modal -->
    <div id="cert-details-modal" class="modal">
        <!-- Content will be populated dynamically -->
    </div>

    <!-- Deployment action form will appear here when adding/editing -->
    <div id="deployment-action-modal" class="modal">
        <div class="modal-content large">
          <!-- Content will be loaded dynamically -->
        </div>
    </div>
    
    <!-- File Browser Modal -->
    <div id="file-browser-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Browse for Location</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="file-browser-container">
                    <div class="file-browser-toolbar">
                        <button id="file-browser-up" class="button" title="Go up one level">
                            <span>&#8593;</span> Up
                        </button>
                        <button id="file-browser-refresh" class="button" title="Refresh">
                            <span>&#8635;</span> Refresh
                        </button>
                        <button id="file-browser-new-folder" class="button" title="New folder">
                            <span>&#128193;</span> New Folder
                        </button>
                    </div>
                    
                    <div class="file-browser-path">
                        <span>Current Path:</span>
                        <input type="text" id="file-browser-current-path" readonly>
                    </div>
                    
                    <div class="file-browser-locations">
                    </div>
                    
                    <div class="file-browser-list" id="file-browser-list"></div>
                    
                    <div class="file-browser-footer">
                        <div class="file-name-input">
                            <label for="file-browser-filename">Filename:</label>
                            <input type="text" id="file-browser-filename">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button" id="file-browser-cancel">Cancel</button>
                <button class="button primary" id="file-browser-select">Select</button>
            </div>
        </div>
    </div>
    
    <!-- Notification container -->
    <div id="notifications-container"></div>

    <!-- JavaScript Files -->
    <script src="js/utils/date-utils.js"></script>
    <script src="js/utils/domain-validator.js"></script>
    <script src="js/utils/ui-utils.js"></script>
    <script src="js/utils/docker-utils.js"></script>
    <script src="js/utils/template-utils.js"></script>
    <script src="js/modules/logger.js"></script>
    <script src="js/cert-actions.js"></script>
    <script src="js/logs-viewer.js"></script>
    <script src="js/settings-ui.js"></script>
    <script src="js/file-browser.js"></script>
    <script src="js/deploy-actions.js"></script>
    <script src="js/main.js"></script>
</body>
</html>